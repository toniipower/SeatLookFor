<p class="escenario">ESCENARIO</p>
<div *ngIf="asientos?.length">
  <div class="mapa-asientos">
    <div *ngFor="let asiento of asientos; let i = index" 
         class="asiento" 
         [ngClass]="{'libre': asiento.estado === 'libre', 
                    'ocupado': asiento.estado === 'ocupado',
                    'seleccionado': estaSeleccionado(asiento)}"
         [style.gridColumn]="asiento.ejeX - 2"
         [style.gridRow]="asiento.ejeY" 
         [title]="'Zona: ' + asiento.zona + ', Precio: ' + asiento.precio"
         (click)="selecionarAsiento(asiento)"
         (mouseenter)="mostrarImagen($event, asiento)"
         (mouseleave)="ocultarImagen()">
      {{asiento.zona}}
      <br>    
      {{ asiento.ejeX + "-" + asiento.ejeY }}
    </div>
  </div>
</div>

<div *ngIf="!asientos?.length">
  <p>No hay asientos disponibles.</p>
</div>

<!-- Tooltip con imágenes de comentarios -->
<div class="tooltip-imagen" *ngIf="mostrarTooltip" 
     [style.left.px]="tooltipX" 
     [style.top.px]="tooltipY"
     (mouseenter)="mouseEntraTooltip()"
     (mouseleave)="mouseSaleTooltip()">
  <div class="tooltip-contenido">
    <div class="carrusel">
      <button class="btn-navegacion anterior" 
              (click)="anteriorImagen()" 
              *ngIf="comentariosAsiento.length > 1">❮</button>
      
      <div class="imagen-comentario">
        <img [src]="getFotoComentario(comentariosAsiento[imagenActual].foto)" 
             [alt]="'Comentario de ' + comentariosAsiento[imagenActual].usuario?.nombre">
        <div class="info-comentario">
          <p class="usuario">{{comentariosAsiento[imagenActual].nombre}} {{comentariosAsiento[imagenActual].apellido}}</p>
          <p class="valoracion">⭐ {{comentariosAsiento[imagenActual].valoracion}}</p>
        </div>
      </div>

      <button class="btn-navegacion siguiente" 
              (click)="siguienteImagen()" 
              *ngIf="comentariosAsiento.length > 1">❯</button>
    </div>
    <div class="indicadores" *ngIf="comentariosAsiento.length > 1">
      <span *ngFor="let comentario of comentariosAsiento; let i = index" 
            [class.activo]="i === imagenActual"
            (click)="imagenActual = i">
        ●
      </span>
    </div>
  </div>
</div>

<!-- Formulario de comentarios -->
<app-comentario-form 
  *ngIf="asientoSeleccionado"
  [asientoSeleccionado]="asientoSeleccionado"
  (comentarioCreado)="onComentarioCreado()">
</app-comentario-form>

<!-- Botón de confirmación -->
<div class="acciones">
  <button [disabled]="asientosSeleccionados.length === 0" routerLink="/resumen">Confirmar Reserva</button>
</div>