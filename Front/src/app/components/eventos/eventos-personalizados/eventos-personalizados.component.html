<div class="layout">
    <app-navbar></app-navbar>
    
    <div class="event">
        <div class="event__reservation">
            <h3>Tu Reserva</h3>
            <div *ngIf="asientosSeleccionados.length > 0">
                <h4>Asientos seleccionados:</h4>
                <ul>
                    <li *ngFor="let asiento of asientosSeleccionados">
                        Zona: {{asiento.zona}} - Fila {{asiento.ejeX}}, Asiento {{asiento.ejeY}} - Precio: {{asiento.precio | number:'1.2-2'}}€
                        <button class="event__btn-eliminar" (click)="eliminarAsiento(asiento)">✕</button>
                    </li>
                </ul>
                <p>Total: {{calcularTotal() | number:'1.2-2'}}€</p>
            </div>
            <p *ngIf="asientosSeleccionados.length === 0">
                No has seleccionado ningún asiento todavía.
            </p>
            <button class="event__button" [disabled]="asientosSeleccionados.length === 0" (click)="confirmarReserva()">Confirmar Reserva</button>
        </div>
        <div class="event__title">
            <p class="event__title-text">{{ datosEvento?.evento?.titulo }}</p>
        </div>

        <div class="event__map">
            <app-asientos *ngIf="datosEvento"
                [asientos]="datosEvento?.asientos || []"
                (asientosSeleccionadosChange)="onAsientosSeleccionados($event)">
            </app-asientos>
        </div>

        <div class="event__info">
            <div class="event__info-image">
                <img [src]="datosEvento?.establecimiento?.imagen" alt="Portada de estableciemiento">
            </div>
            <div class="event__info-name">
                <h3>{{datosEvento?.establecimiento?.nombre }}</h3>
            </div>
            <div class="event__info-content">
                <p>Seccion de informacion sobre de evento</p>
                <p>
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Et, dicta vitae id omnis sed quasi
                    inventore tempora aut! Tempora repellendus, molestiae consectetur voluptas laborum soluta et! Nesciunt
                    laboriosam porro magnam.
                    Consectetur voluptatum, perferendis doloremque sapiente eius enim cumque dolores, fugiat, culpa
                    temporibus nihil obcaecati natus provident ipsum deserunt saepe quis reprehenderit repellendus iure
                    qui mollitia exercitationem quaerat. Excepturi, nihil quos.
                    Quos minus voluptatum quibusdam repellat ut. Impedit quis dicta corrupti amet? Nobis cupiditate
                    rerum similique quidem accusantium, consequatur excepturi doloremque eum aut dolorem quis voluptas, iure
                    blanditiis! Autem, reiciendis velit!
                    Quaerat explicabo perspiciatis suscipit neque nisi commodi, earum nihil adipisci ipsa quis
                    necessitatibus ducimus? Iste, ipsum. Dolor cupiditate nisi iure, nemo rerum harum cumque explicabo?
                    Fugit laudantium unde excepturi quis.
                    Hic sint rem sit quasi doloremque fugiat qui architecto ea at. Velit corporis, id dicta aut hic
                    facere tenetur temporibus sequi. Similique quas placeat soluta rerum quaerat corporis ea quam!
                    lorem*2
                </p>
            </div>
        </div>
        <div class="event__comments">
            <h3 class="event__comments-title">COMENTARIOS</h3>

            <div *ngIf="comentariosEvento.length > 0; else sinComentarios">
                <div class="event__comment" *ngFor="let comentario of comentariosEvento">
                    <div class="event__comment-header">
                        <div class="event__comment-user">
                            <div class="event__comment-name">
                                {{ comentario?.nombre || comentario?.usuario?.nombre || 'Usuario' }}
                                {{ comentario?.apellido || comentario?.usuario?.apellido || '' }}
                            </div>
                        </div>
                    </div>

                    <div class="event__comment-content" *ngIf="comentario?.opinion">
                        <div class="event__comment-rating">
                            <ng-container *ngFor="let star of getEstrellas(comentario?.valoracion)">
                                ⭐
                            </ng-container>
                        </div>
                        <p>{{ comentario.opinion }}</p>

                        <img
                            *ngIf="comentario.foto"
                            [src]="getFotoComentario(comentario.foto)"
                            alt="imagen del comentario"
                            class="event__comment-image"
                        />
                    </div>
                </div>
            </div>

            <ng-template #sinComentarios>
                <p>No hay comentarios disponibles para este evento.</p>
            </ng-template>
        </div>
    </div>
     
    <app-footer></app-footer>
</div>
